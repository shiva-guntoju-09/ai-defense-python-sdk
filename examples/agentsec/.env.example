# =============================================================================
# Environment Variables for agentsec Examples
# =============================================================================
# Copy this file to .env and fill in your values.
# WARNING: Never commit .env to version control!
# =============================================================================

# =============================================================================
# Cisco AI Defense Integration Mode
# =============================================================================
# Choose integration mode for LLM and MCP independently:
#   api     = Use Cisco AI Defense API for inspection (default)
#   gateway = Route calls through Cisco AI Defense Gateway

AGENTSEC_LLM_INTEGRATION_MODE=gateway
AGENTSEC_MCP_INTEGRATION_MODE=gateway

# =============================================================================
# Cisco AI Defense API Mode Configuration
# =============================================================================
# These settings apply when AGENTSEC_*_INTEGRATION_MODE=api

# LLM API credentials (for AI Defense inspection)
AI_DEFENSE_API_MODE_LLM_ENDPOINT=https://preview.api.inspect.aidefense.aiteam.cisco.com/api
AI_DEFENSE_API_MODE_LLM_API_KEY=your-ai-defense-api-key

# MCP API credentials (for AI Defense inspection)
AI_DEFENSE_API_MODE_MCP_ENDPOINT=https://sam-aid-000692.api.inspect.aidefense.aiteam.cisco.com/api
AI_DEFENSE_API_MODE_MCP_API_KEY=your-mcp-api-key

# -----------------------------------------------------------------------------
# API Mode - Fine-Grained Control
# -----------------------------------------------------------------------------
# Per-type modes: off | monitor | enforce
#   off        = No inspection for this type
#   monitor = Inspect & log, never block
#   enforce = Inspect & block policy violations

# LLM inspection mode (for API mode)
AGENTSEC_API_MODE_LLM=enforce

# MCP tool inspection mode (for API mode)
AGENTSEC_API_MODE_MCP=enforce

# Per-type fail-open behavior for API mode (true = allow on API errors, false = block)
AGENTSEC_API_MODE_FAIL_OPEN_LLM=false
AGENTSEC_API_MODE_FAIL_OPEN_MCP=false

# =============================================================================
# Cisco AI Defense Gateway Mode Configuration
# =============================================================================
# These settings apply when AGENTSEC_*_INTEGRATION_MODE=gateway
# Gateway mode routes calls through Cisco AI Defense Gateway which handles enforcement
#
# Each LLM provider has its own gateway connection URL and API key.
# Requests are sent in native format (no conversion needed).

# -----------------------------------------------------------------------------
# Provider-Specific Gateway URLs and API Keys
# -----------------------------------------------------------------------------
# Each provider (OpenAI, Azure OpenAI, Vertex AI, Bedrock) has a separate
# gateway connection with its own URL and API key.

# OpenAI Gateway
AGENTSEC_OPENAI_GATEWAY_URL=https://gateway.preview.aidefense.aiteam.cisco.com/your-tenant/connections/your-openai-conn
AGENTSEC_OPENAI_GATEWAY_API_KEY=your-openai-gateway-key

# Azure OpenAI Gateway
AGENTSEC_AZURE_OPENAI_GATEWAY_URL=https://gateway.preview.aidefense.aiteam.cisco.com/your-tenant/connections/your-azure-conn
AGENTSEC_AZURE_OPENAI_GATEWAY_API_KEY=your-azure-openai-gateway-key

# Vertex AI Gateway
AGENTSEC_VERTEXAI_GATEWAY_URL=https://gateway.preview.aidefense.aiteam.cisco.com/your-tenant/connections/your-vertexai-conn
# Note: Vertex AI gateway uses ADC OAuth2 token (no static API key needed)

# AWS Bedrock Gateway
AGENTSEC_BEDROCK_GATEWAY_URL=https://gateway.preview.aidefense.aiteam.cisco.com/your-tenant/connections/your-bedrock-conn
# Note: Bedrock gateway uses AWS Sig V4 auth (no API key needed)

# MCP Gateway (single gateway for all MCP connections)
AGENTSEC_MCP_GATEWAY_URL=https://gateway.agent.preview.aidefense.aiteam.cisco.com/mcp/tenant/your-tenant/connections/your-connection/server/your-server
AGENTSEC_MCP_GATEWAY_API_KEY=your-mcp-gateway-api-key

# -----------------------------------------------------------------------------
# Gateway Mode - Control
# -----------------------------------------------------------------------------
# Per-type modes: off | on
#   off = Do not route through gateway (bypass)
#   on  = Route through gateway (gateway handles enforcement)
# Note: No monitor/enforce options - gateway handles enforcement internally

# LLM gateway mode
AGENTSEC_GATEWAY_MODE_LLM=on

# MCP gateway mode
AGENTSEC_GATEWAY_MODE_MCP=on

# Per-type fail-open behavior for Gateway mode (true = allow on gateway errors, false = block)
AGENTSEC_GATEWAY_MODE_FAIL_OPEN_LLM=false
AGENTSEC_GATEWAY_MODE_FAIL_OPEN_MCP=false

# =============================================================================
# General agentsec Settings
# =============================================================================

# Log level: DEBUG | INFO | WARNING | ERROR
AGENTSEC_LOG_LEVEL=DEBUG

# =============================================================================
# MCP Server (Optional - for tool integration)
# =============================================================================
MCP_SERVER_URL=https://remote.mcpservers.org/fetch/mcp
MCP_TIMEOUT=60  # Timeout in seconds for MCP calls (default: 60)

# =============================================================================
# AWS Bedrock Authentication (for API mode - direct calls)
# =============================================================================
# Choose ONE auth method:
#   session_token - STS temporary credentials (recommended for production)
#   profile       - Named AWS profile from ~/.aws/credentials
AWS_AUTH_METHOD=profile

# AWS Region
AWS_REGION=us-east-1

# -----------------------------------------------------------------------------
# For AWS_AUTH_METHOD=session_token (STS temporary credentials)
# -----------------------------------------------------------------------------
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_SESSION_TOKEN=

# -----------------------------------------------------------------------------
# For AWS_AUTH_METHOD=profile (named profile)
# -----------------------------------------------------------------------------
AWS_PROFILE=default

# =============================================================================
# Azure OpenAI (for API mode - direct calls)
# =============================================================================
AZURE_OPENAI_ENDPOINT=https://aidefense-threatintel.openai.azure.com/
AZURE_OPENAI_API_KEY=your-azure-openai-key

# =============================================================================
# Microsoft Azure AI Foundry Deployment Configuration
# =============================================================================
# These settings are used for deploying agents to Azure AI Foundry.
# The LLM gateway/API settings above (AGENTSEC_AZURE_OPENAI_*) are reused.

# -----------------------------------------------------------------------------
# Azure Authentication (for Foundry deployments)
# -----------------------------------------------------------------------------
# Option 1: Service Principal (recommended for CI/CD)
AZURE_TENANT_ID=
AZURE_CLIENT_ID=
AZURE_CLIENT_SECRET=

# Option 2: Use Azure CLI login (run: az login)
# No env vars needed - uses DefaultAzureCredential

# -----------------------------------------------------------------------------
# Azure Subscription & Resource Group
# -----------------------------------------------------------------------------
AZURE_SUBSCRIPTION_ID=
AZURE_RESOURCE_GROUP=

# -----------------------------------------------------------------------------
# Azure AI Foundry Project
# -----------------------------------------------------------------------------
AZURE_AI_FOUNDRY_PROJECT=
AZURE_AI_FOUNDRY_ENDPOINT=

# -----------------------------------------------------------------------------
# Azure Container Registry (for container deployments)
# -----------------------------------------------------------------------------
AZURE_ACR_NAME=
AZURE_ACR_LOGIN_SERVER=

# -----------------------------------------------------------------------------
# Azure Functions (for serverless deployments)
# -----------------------------------------------------------------------------
AZURE_FUNCTION_APP_NAME=
AZURE_STORAGE_ACCOUNT=

# =============================================================================
# GCP Vertex AI (for API mode - direct calls)
# =============================================================================
# Vertex AI uses Application Default Credentials (ADC)
# Run: gcloud auth application-default login
# Or set GOOGLE_APPLICATION_CREDENTIALS to service account key file
GOOGLE_CLOUD_PROJECT=your-gcp-project-id
GOOGLE_CLOUD_LOCATION=us-central1
# GKE Master Authorized Networks (required by Cisco security guardrails)
# Get your IP: curl ifconfig.me
GKE_AUTHORIZED_NETWORKS=YOUR_PUBLIC_IP/32

# =============================================================================
# OpenAI (for API mode - direct calls)
# =============================================================================
OPENAI_API_ENDPOINT=https://api.openai.com/v1
OPENAI_API_KEY=sk-your-openai-api-key

# =============================================================================
# agentsec Rules Configuration
# =============================================================================
# Rules to enable for LLM inspection (comma-separated or JSON array)
AGENTSEC_LLM_RULES=jailbreak,prompt_injection

